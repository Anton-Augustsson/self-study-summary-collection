\chapter{Probability and Statistics DV}

\newpage

\begin{multicols}{2}
\section{Statistisk mått och begreppet sannolikhet}
\subsection{Begrepp}
\begin{itemize}
    \item Deterministiska modeler: enkla modeler som inte tar hänsyn till fel
    \item Sannolikhetsteori: modelera slumpmäsiga fel
    \item s..k: a..u slumpmässig data
    \item Beskrivande statistik:
    \begin{itemize}
        \item Population: Alla bilar i uppsala
        \item Stickprov: 100 utvalda bilar i uppsala
        \item Enhet: En av det 100 utvalda
        \item Variabler: Motorstyrka, dragkrok, automat etc
        \begin{itemize}
          \item Kvalitativa: (dragkrok, automati/manuel)
          \item Kvantitativa: (Motorstyrka, vikt)
        \end{itemize}
        \item Tvärsnitts data: Befolkning i sverige städer 1 jan 2018
        \item Longitudinella data: Befolking i uppsala under 1 jan 1960 till 2020
    \end{itemize}
    \item Statistisk mått:
    \begin{itemize}
        \item Lägesmått:
        \begin{itemize}
          \item Aretmetisk modelera: $ \overline{x} = \frac{\sum_{k=1}^{n} x_k}{n} $
          \item median: $(\not{1}, \not{1}, \not{2}, 4, \not{4}, \not{4}, \not{7}), (\not{1}, \not{1}, 2, 4 \not{4}, \not{4})$
        \end{itemize}
        \item Kvartiler: Tre punkter, fyra i quarters, som delar upp tal serie
        \begin{itemize}
          \item 1:a kvartilen (Nedre kvartil) mittpunkten av den nedre halvan
          \item 3:e kvartilen (Övre kvartil) mittpunken av den övre halvan
        \end{itemize}
        \item Spridningsmått:
        \begin{itemize}
            \item Kvartal bred: 3:e kvartalen $-$ 1:a kvartalen
            \item Stickprovs standard divianse (standard diviaion): $s=\sqrt{\frac{1}{n-1}\sum_{i=1}^{n}(x_i - \overline{x})^2}$
            %\item Savaraten (skatt plots): varge enkel två ???
            \item Spridnings diagram: Positiv korelation, negativ korelation, ingen korelation, perfect korelation
        \end{itemize}
    \end{itemize}
    \item Diskret variable: räknerligt många värden
    \item Kontinuerlig variabel: tar oräknerligt många värden, värden i ett interval
    \item Dickreta visualiseras: med stolpdoagram
    \item Kontinuerlig variabel visualisering: med histogram
    \item Lådiagram:
    \item Sannolikhetsteori: Vi antar att ett försek genomförs $n$ gånger oberonde av varandra. En händelse $A$ inträfar $f$ gånger
    \begin{itemize}
      \item Frekvenskvoteten: $\frac{f}{n}$
      \item Exprimentellt bestömt närmevärde: frekenskvoten på $p(A)$
        \begin{itemize}
          \item Def: (Frekvensbaserad sannoliket): $p(A) \lim_{n\to\infty}$
            \item Def: (Klassisk sannoliket) Anta att fersek kan utföras på $m$ olika olika sätt varav $g$ är gynnsama (innebär $A$). Då är $p(A)=g/m$
        \end{itemize}
      \item Utfallsrum: $\Omega$ alla möjliga värden som slumpvariabeln kan ta
      \item Händelser: är delmängden av utfalsrummet
      \item Slumpvariabler: Stokastisk variabel
    \end{itemize}
\end{itemize}

\textbf{Kotmogorovs axiom}
\begin{align*}
  I &\text{ För varje händelse $A$ gäller att } P(A) \geq 0 \\
  II &\text{ Sannolikhet för utfallsrumet är } 1 P(\Omega)=1 \\
  III &\text{ Om $A$ och $B$ är händelser och } A\cap{B}=\not{o} \\
  &\text{ (oförsenliga hänelser) gäller } P(A\cup{B}) = P(A) + P(B) \\
  &\Rightarrow P(A\cup{B})=P(A)+P(B)-P(A\cap{B}) \\
\end{align*}

\newpage

\section{Sannolikheter och slumpvariabler}
\textbf{Användbara räkneregler}
\begin{align*}
  1 \; &P(A^*) = 1-P(A) \\
  2 \; &P(A\cup{B}) = P(A)+P(B)-P(A\cap{B}) \\
  3 \; &P(A|B) = \frac{A\cap{B}}{P(B)} \\
\end{align*}

\subsection{Betingade sannolikheter}
\begin{center}
\begin{tabular}{|c|c|c|c|}
 \hline
 Type & Dyglig & Defekt & Tot \\
 \hline
 Äldre & 170 & 10 & 180 \\
 \hline
 Ny & 115 & 5 & 120 \\
 \hline
\end{tabular}
\end{center}
\begin{align*}
  &A = \text{ ``Slumpmässigt vald produkt är dyglig'' } \\
  &B = \text{ ``Slumpmässigt vald produkt är tillverkad} \\
  &\text{vid äldre maskin.''} \\
  &P(A) = \frac{285}{300} = 0.95 \\
  &C = \text{ Slumpmässigt vald produkt är dyglig givet} \\
  &\text{att den är tillvärkad vid äldre maskinger } \\
  &\\
  &P(C) = P(A|B) = \frac{P(A\cap{B})}{P(B)} = \frac{170}{180} \approx 0.94 \\
\end{align*}

\subsection{Kedjer av händelse}
\begin{align*}
  &P(A\cap{B}\cap{C}) = P(C|A\cap{B})P(A\cap{B}) \\
  &= P(C|A\cap{B})P(B|A)P(A)  \\
\end{align*}

\textbf{Bayes sats}
\begin{align*}
  &\quad  P(B|A) = \frac{P(B)P(A|B)}{P(A)}  \\
\end{align*}

\textbf{Lagen om total sannolikhet}
\begin{align*}
  &\quad  P(B) = P(B|A)P(A) + P(B|A^*)P(A^*) \\
\end{align*}

\subsection{Oberonde händelser}
\begin{align*}
  &P(A|B)=P(A) \\
  & \\
  &\text{Betingad sannolikhet: } P(A\cap{B})=P(A|B)P(B) \\
  &\text{ om A och B är oberonder } \\
  &\Rightarrow P(A\cap{b}) = P(A)P(B) \\
  & \\
\end{align*}

\textbf{Födelsedagsparadoksen}
\begin{align*}
  &\quad  1-(\prod_{k = 1}^{n} \frac{365-k}{365}) \\
\end{align*}

\textbf{Slumpvariablel}
\begin{align*}
  &\text{Är en function från utfalsrumet $\Omega$ till någon mängd} \\
  & E,\; X:\Omega\to{E} \\
  & \\ % more details
  &X\in\{0,1,2,3\} \\
  &P(X=0)+P(X=1)+P(X=2)+P(X=3)=1 \\
  &\text{ Kolmogorovis axiom } \\
  & \\
  &\text{ Sannolikhetsfaktor? är $P_X(x)$ } P_X(x)=P(X=x) \\
\end{align*}

\section{Fördelningar}
\begin{tabular}{|c|c|}
 \hline
 Diskreta fördelningar & Kontenuerliga fördelningar \\
 \hline
 $\Omega=\{1,2,3\}$      & $\Omega=[0,1]$ \\
 $\Omega=\{0,2,...\}$    & $\Omega=\mathbb{R}$ \\
 \hline
 Sannolikhetsfunktion  & Täthetsfunktion \\
 $p_X(x)=P(X=x)$       & $f_X(x)=\int_a^b f_X(x)dx=P(a\leq{x}\leq{b})$ \\
                       & $P(X=x)=0$ \\
 \hline
 $\sum_{x\in{\Omega}} p_X(x)=1$       & $\int_{\Omega} f_X(x)dx=1$ \\
 \hline
 $E[X]= \sum_{x\in{\Omega}} xp_X(x)$  & $E[X]= \int_{\Omega} xf_X(x)dx$ \\
 \hline
 $V[X]= E[X^2] - E[X]^2$            & $V[X]= E[X^2] - E[X]^2$ \\
 \hline
 $F_X(x)=\sum_{i\leq{x}} p_X(i)$     & $F_X(x)=\int_{-\infty}^x f_X(x)dx=1$ \\
 $      =p(X\leq{x})$               & $     =P(X\leq{x})$ \\
                                    & $     =P(X<x)$ \\
 \hline
\end{tabular}

\subsection{Binomial-fördelningar}
\begin{align*}
  &\text{Tillämpning: man utför något n anatal gånger med} \\
  &\text{sannolheten p att det lyckas.} \\
  &\\
  &\text{Om $X$ är binomialfördelad med paramter $n$ och $p$.} \\
  &\text{Då gäller:} \\
  &P(X=x) = \begin{pmatrix} n \\ x \end{pmatrix} p^x(1-p)^{n-x}, \, x=0,1,2,..,n  \\
  &X \sim Bin(n,p) \\
  %&\quad  P_X(x) = P(X\leq{x}) = \sum_{i=x} P_X(i) \\
  %&\quad  \text{Spesialfall om $n=1$: Bernorlii-fördelning} Be(p)= Bin(1,p) \\
  &\\
  &E[X]=np \\
  &V[X]=np(1-p) \\
  &\\
  &dbinom(x, n, p) \\
  &pbinom(x, n, p, lower.tail = FALSE) \\
\end{align*}


\subsection{Possion-fördelningar}
\begin{align*}
  &\text{Tillämpning: För att modelera sällsynta händelser.} \\
  &\\
  &\text{Om $X$ är possionsfördelad med paramter $m$.} \\
  &\text{Då gäller} \\
  &P(X=x) = \frac{m^x}{x!}e^{-m}, \, x=0,1,2,..,n  \\
  &X \sim Po(\mu) \\
  &\\
  &E[X]=\mu \\
  &V[X]=\mu \\
  &\\
  &dpois(x, \mu) \\
  &ppois(x, \mu, lower.tail = FALSE) \\
\end{align*}

\subsection{Likformig/rektangulär-fördelningar}
\begin{align*}
  &\quad  \text{Tillämpning: Lika fördelade inom ett intervall.} \\
  &\quad  \\
  &\quad  \text{Om $X$ är likformig på intervallet $[a,b]$. Då gäller} \\
  &\quad  f_X(x) = \frac{1}{b-a}, \, a\leq{x}\leq{b} \\
  &\quad  X \sim Re(a,b) \\
  &\quad  \\
  &\quad  E[X]=(a+b)/2 \\
  &\quad  V[X]=(b-a)^2/12 \\
  &\quad  \\
  &\quad  dunif(x, a, b) \\
  &\quad  punif(x, a, b) \\
\end{align*}

\subsection{Exponential-fördelningar}
\begin{align*}
  &\text{Tillämpning: Livslängd/väntetid.} \\
  &\\
  &\text{Om $X$ är exponetialfördelad med paramter $ a > 0 $.} \\
  &\text{Då gäller} \\
  &f_X(x) = \frac{1}{\lambda} e^{-x/\lambda}, \, x\leq{lambda} \\
  &X \sim Exp(\lambda) \\
  &\\
  &E[X]= 1/\lambda \\
  &V[X]= 1/\lambda \\
  &\\
  &dexp(x, \lambda) \\
  &pexp(x, \lambda) \\
\end{align*}

\subsection{Normalfördelning-fördelningar}
\begin{align*}
  &\text{Tillämpning: Allt möjligt.} \\
  &\\
  &\text{Om $X$ är normalfördelad med paramter $\mu$ och $\sigma^2$.} \\
  &\text{Då gäller} \\
  &f_X(x) = \frac{1}{\sigma\sqrt{2\pi}} e^{-(x-\mu)^2/2\sigma}, -\infty<x<\infty \\
  &X \sim N(\mu,\sigma^2) \\
  &\\
  &E[X]= \mu \\
  &V[X]= \sigma^2 \\
  &\\
  &dnorm(x, \mu, \sigma) \text{ täthetsfunktionen} \\
  &\text{(behövs inte för kontinuerliga)} \\
  &pnorm(x, \mu, \sigma) \text{ fördelningsfunktion} \\
  &\text{(behövs inte för kontinuerliga)} \\
\end{align*}


\subsection{Läges och spridningsmått}
\subsubsection{Väntevärde}
\begin{align*}
  &\quad  \text{(Diskret) }      E[X] = \sum_{x\in\Omega} x P_X(x) \\
  &\quad  \text{(Kontinuerlig) } E[X] = \int_{\Omega} x f_X(x) \\
\end{align*}

\subsubsection{varians}
\begin{align*}
  &\text{Om $X$ är slumpvariabler med väntevärde $\mu$.} \\
  &\text{Då gäller} \\
  &\text{(Diskret) }      V[x] = \sum_{x\in\Omega} (x-\mu)^2  \\
  &\text{(Kontinuerlig) } V[X] = \int_{\Omega} (x-\mu)^2 f_X(x)dx \\
\end{align*}

\subsubsection{Alternativ form}
\begin{align*}
  &\quad  \text{(Diskret) }      E[X^i] = \sum_{x\in\Omega} x^i P_X(x) \\
  &\quad  \text{(Kontinuerlig) } E[X^i] = \int_{\Omega} x^i f_X(x) \\
  &\quad  V[x]=E[x^2]-(E[x])^2 \\
\end{align*}

\section{Olikheter}
\subsection{Markovs olikhet}
\begin{align*}
  &\quad  \text{Om $X$ är ickenegatic $(x\leq{0})$ och $a>0$. Då gäller} \\
  &\quad  p(x\geq{a}) \leq \frac{E[x]}{a} \\
\end{align*}

\subsection{Thebysjovs olikhet (chebyshev)}
\begin{align*}
  &\text{Om $X$ är en slumpvariabel med $E[X]=\mu$ och} \\
  &V[X]=\sigma^2. \text{ Då gäller:} \\
  &p(|x-\mu| \geq{k\sigma}) \leq \frac{1}{k^2} \\
\end{align*}

\subsection{Fördelnings functioner}
\begin{align*}
  &\quad  \text{(Diskret) }      p(X\leq{x}) = F_X(x) = \sum_{i\leq{x}} P(X=x) \\
  &\quad  \text{(Kontinuerlig) } p(X\leq{x}) = F_X(x) =  \int_{-\infty}^{x} f_X(x)dx \\
\end{align*}

\subsubsection{Normalfördelning}
\begin{align*}
  &\text{Vi kan inte integrera täthetsfunctionen} \\
  &\text{-ingen stängd form för fördelings funktionen} \\
  &\text{special fall: } X\sim{N(0,1)} \text{(standard normalfördelning)} \\
  &\text{Vi betecknar fördelnings funktionen } \Phi(x) = P(X\leq{x}) \\
\end{align*}

\subsubsection{kvartier}
\begin{align*}
  &\quad  \text{För $0<x<1$ defineras $\alpha$-kvantilen $x_{\alpha}$ till} \\
  &\quad  \text{slupvariabel $x$ som en lösning till } \\
  &\quad  F_X(x_\alpha) = 1-\alpha \\
\end{align*}

\subsection{Oberonede slupvariabel}
\begin{align*}
  &\quad  \text{Två slumpvariabler $x_1 \land x_2$ kallas oberonde om} \\
  &\quad  P({x_1\in A} \cap  {x_2\in B}) = P(x_1\in A)P(x_2\in B) \\
  &\quad  \text{för alla mängder $A\sqsubseteq \Omega_1, \, B\sqsubseteq \Omega_2$} \\
\end{align*}

\begin{align*}
  &\quad  E[Y] = a+bE[x] \\
  &\quad  V[Y] = b^2V[x] \\
\end{align*}

\subsubsection{räkneregler}
\begin{align*}
  &Y = a_1x_1 + a_2x_2 + \ldots+ a_n x_n \text{ slupvaribler} \\
  &x_i \text{ konstanter } a_i \\
  &E[Y] =  a_1 E[x_1] + a_2 E[x_2] + \ldots + a_n E[x_n] \\
\end{align*}

\noindent\textbf{Exempel (505): räkneregler}
\begin{align*}
  &\text{Låt $X\sim N(10,4), Y\sim N(3,1)$ vara oberonde} \\
  &\text{slumpvariabler.} \\
  &\text{Beräkna sannolikheten att $X>3Y$} \\
  &\\
  &\text{Låt } Z=X-3Y \Rightarrow E[Z]=E[X]-3E[Y] \\
  &=10-3*3=1 \\
  &V[Z]=E[X]+(-3)^2E[Y]=10=(-3)^2*3=13 \\
  &\text{Enligt normalfördelingien så får vi } Z\sim N(1,13) \\
  &\text{Därmed kan vi beräkna följande sannolikhet} \\
  &P(X-3Y>0)=P(Z>0)=1-P(z\leq0) \\
  &1-\Phi(-1/\sqrt{13})=1-\Phi(1-\Phi(1/\sqrt{13})) = \Phi(0.28) \\
  &= 0.61 \\
\end{align*}

\subsubsection{väntevärde av produkter}
\begin{align*}
  &\quad  \text{Om $x_1,\ldots,X_n$ är oberonde då gäller}\\
  &\quad  E[x_1,\ldots,X_n] = E[x_1] \ldots E[x_n] \\
\end{align*}

\subsubsection{Special fall}
\begin{align*}
  &\quad  \overline{x} = \frac{1}{n}(x_1,\ldots,X_n) \\
  &\quad  \text{där $x$ är oberonde och diktördelade med} \\
  &\quad  E[x_i] = \mu, \, V[x_i] = \sigma^2 \\
  &\quad  E[x] = \mu, \, V[x] = \frac{\sigma^2}{n} \\
\end{align*}

\subsection{Fördelning av summor}
Binomialfördelning, Possionfördelning, Linjärkombination av normalfördelade variabler.

\subsection{Central gränsvärdessatsen (CGS)}
\begin{align*}
  &\quad  \text{Exakt fördelning för summor är svårt i allmänhet} \\
  &\quad  \text{därmed andvänder man CGS} \\
  &\quad  \\
  &\quad  Y = X_1+X_2+\ldots+X_n \\
  &\quad  Y \sim N(\mu_Y, \sigma_Y^2) \\
\end{align*}

\textbf{Example}
\begin{align*}
  &\quad  X_i \sim Bin(1,0.2) \\
  &\quad  Y=\sum_{i=1}^{30} X_i \\
  &\quad  P(Y\leq8)=? \\
  &\quad  \\
  &\quad  \text{CGS: } Y\sim{N(\mu_Y, \sigma_Y^2)} \\
  &\quad  \mu_Y=E[Y]=30*E[X_i]=30*0.2=6 \\
  &\quad  \sigma_Y^2=V[Y]=30*V[X_i]=30(1*0.2*0.8)=4.8 \\
  &\quad  P(Y\leq8)=pnorm(8, 6, sqrt(4.8))\approx 0.82 \\
  &\quad  P(\sum_{i=1}^{30} X_i\leq8)\approx 0.87 \\
\end{align*}

\section{Simulering av slumptal}
\subsection{äkta slummpmässiga tal}
Hårdvaru genererade tal:
 \begin{itemize}
  \item Tärningar, rolethjul ..
  \item Radiaktivit sönderfall
  \item Atmosfäriskt brus (random.org)
\end{itemize}

\subsection{Pseudoslumpmässiga tal}
Dator generede slump tal. Kommer att upredasig.
\begin{itemize}
  \item Tar in en seed som input för att generera sluptal
  \item Defoult seed är oftast tid
  \item det är diterministiska
  \item Har en persiod med nya tal sedan så uprepar det sig
\end{itemize}

\subsubsection{Von Neumann}
\begin{enumerate}
  \item Väljer seed: $u_0=0.1111$ \\
  \item Skapar $y_0=1111$ \\
  \item Beräknar $y_0^2=1234321$ \\
  \item Fyller på från venster med noll för att få $8$ siffror $01234321$ \\
  \item Skapar genom att ta det fyra mitersta siffrorna $y_1=2343$ \\
  \item $0.2343 \Rightarrow y_1^2=5489649 \Rightarrow y_2=4896 \Rightarrow u_2=0.4896$ \\
\end{enumerate}

\subsubsection{Kongruens}
\begin{align*}
  &V_{n+1}=aV_n+b (\mod c) \\
  &\text{Vi är ett heltal mellan $0$ och $c-1$ och $u_1=\frac{V_i}{c}$ }\\
  &\text{a,b,c måste väljas noggrant} \\ 
  &\text{(talteori, c måste vara ett primtal)} \\
  &\text{vanliga val är } a=7^7=16807, \, b=0, \, \\
  &c=2^{31}-1= 2 147 483 647 \\
  &\text{hat svagheter, andvänds inte längre} \\
\end{align*}

\subsubsection{XOR-generator}
Extrem snabb, lätt att förstå.
\begin{enumerate}
  \item Väljer seed: $m$ binära bits (heltal mellan $0$ och $2^m-1$).
  \item Skifta alla bits $l$ steg åt vänster och fyll i från höger med nollor.
  \item XOR med seed och det skiftade talet (seed update).
  \item Skifta seed update $m-l=r$ steg åt höger och fyll i nollor från vänster.
  \item XOR med seed update och högerskiftet.
  \item Konvertera till ett tal mellan $0$ och $1$.
\end{enumerate}

\subsubsection{Mersenne Twister}
\noindent\textbf{Exempel (505): räkneregler}
\begin{align*}
  &\text{Givet $5$ psudoslumpmässiga tal från $Re[0,1]$} \\
  &u_1=0.8147, \, u_2=0.9058, \, u_3=0.1270, \, u_4=0.9134, \\
  &u_5=0.634 \\
  &\text{Simulera $5$ ?dosernar? från slumpvariablen $X$ med }\\
  &f_X(x)=\frac{x}{2}, \, 0 \leq x \leq 2 \\
  &\text{Beräna $E[x]$ och jämför med medvärder av de} \\
  &\text{simmulerade dosetaner} \\
  &\\
  &\text{Tar fram primitiva functionen } F_X(x)=\int_0^x \frac{t}{2}dt \\
  &= {{[t^2/4]}_0}^x=\frac{x^2}{4} \\
  &\text(Tar fram inversen ) y=\frac{x^2}{4} \Rightarrow x=2\sqrt{y} \\
  &x_1=F_x^{-1}(u_1) = 2\sqrt{x} = 1.8052 \\
  &x_2=F_x^{-1}(u_2) = 2\sqrt{x} = 1.9035 \\
  &x_3=F_x^{-1}(u_3) = 2\sqrt{x} = 0.7127 \\
  &x_4=F_x^{-1}(u_4) = 2\sqrt{x} = 1.9114 \\
  &x_5=F_x^{-1}(u_5) = 2\sqrt{x} = 1.5905 \\
  &\text{Beräknar väntevärdet } E[x] \int_0^2x\frac{x}{2}dx=[\frac{x^3}{6}]_0^2 \\
  &= \frac{8}{6} = \frac{4}{3} \approx 1.33 \\
\end{align*}

\section{Statistikens grunder}
\subsection{Allmänt}
\begin{align*}
  &\text{Skattning av en okänd parameter $\theta$ från en familj} \\
  &F_X(\theta) \text{ är en funktion}  \\
  &\hat{\theta} = t = g(x_1,x_2,...,x_n) \\
\end{align*}

\subsection{Medelfel}
\begin{align*}
  &\sigma^2 \land p \text{ kan vara okända}\\
  &\text{Vi kan definera medel felet genom att} \\
  &\text{andvända skattningen.} \\
  &s=\hat{\sigma} \land \hat{p} \\
  &V[\hat{\mu}]=\frac{\sigma^2}{n}  \\
  &V[\hat{p}]  =  \frac{\hat{p}(1-\hat{p})}{n} \\
  &d[T_{\mu}]   = \frac{s}{\sqrt{n}} \\
  &d[T_{p}]     = \sqrt{\frac{\hat{p}(1-\hat{p})}{n}} \\
  &\text{Utifrån medelfelet definerar vi konsistens och} \\
  &\text{effektivitet.} \\
  &\text{\textbf{Konsistans} $V[T]\to0$ då $n\to\infty$} \\
  &\text{\textbf{Effektivitet} Givet estimatorn $T_1,T_2$ så är $T_1$} \\
  &\text{effekten att $T_2$ om $V[T_1]<V[T_2]$ ($D[T_1]<D[T_2]$)} \\
\end{align*}

\textbf{Exempel}
\begin{align*}
  &\quad  \text{Vi beräknar variansen på $T_{\mu}$ och $T_{\mu}$}  \\
  &\quad  V[T_{\mu}] = V[1/n(x_1,x_2,...,x_n)] \\
  &\quad  V[T_{\mu}] = 1/n^2(V[x_1] = V[x_2] + ... +V[x_n]) \\
  &\quad  V[T_{\mu}] = \frac{1}{n^2} n\sigma^2 = \frac{\sigma^2}{n} \\
  &\quad  V[T_{p}] = V[x/n] \\
  &\quad  V[T_{p}] = \frac{1}{n^2}V[x] \\
  &\quad  V[T_{p}] = \frac{1}{n^2} np(1-p) \\
  &\quad  V[T_{p}] = \frac{p(1-p)}{n} \\
\end{align*}

\subsection{Skattning av varians}
\begin{align*}
  &\quad  N(\mu,\sigma^2) \text{ -Vill skatta $\sigma^2$ det går att visa att }  \\
  &\quad  S^2 = \hat{\sigma}^2 = \frac{1}{n-1}\sum_{i=1}^n (x_i-\overline{x})^2 \\
  &\quad  \text{är en venteriktig skattning av variansen }  \\
  &\quad  \\
  &\quad  \text{Vi kan visa att }  \\
  &\quad  S_p^2 = \frac{(n_1-1)S_1^2 + (n_2-1)S_2^2 + (n_3-1)S_3^2}{(n_1-1)+(n_2-1)+(n_3-1)}\\
  &\quad  \text{är en väntevärdsriktig skattning av } \sigma^2  \\
\end{align*}

\textbf{Def}
\begin{align*}
  &\quad  \text{Låt $A$ och $B$ vara funktioner av $x_1,x_2,...,x_n$ så att} \\
  &\quad  \text{Då kallas $[A,B]$ ett $100(1-\alpha)$ -procent} \\
  &\quad  \text{konfidensintervall för $\theta$ (med konfidensgrad $1-\alpha$)} \\
\end{align*}

\subsection{Väntevärdsriktig}
\textbf{Exempel}
\begin{align*}
  &X\sim{N(m_1-m_2, 4)}, \; Y\sim{N(m_1+m_2,5)} \\
  &\text{a. Visa att $\hat{m}_1=(X+Y)/2$ är väntevärdesriktig} \\
  &\text{skattning av $m_1$} \\
  &E(\hat{m}_1) = E[(X+Y)/2] = 1/2(E[X]+E[Y]) \\
  &= 1/2(m_1-m_2 + m_1+m_2)= \frac{1}{2}2m_1=m_1 \\
  &\text{därmed så är den väntevärds riktig} \\
  &\\
  &\text{b. Beräkna standardavvikelsen för $\hat{m}_1$} \\
  &D(\hat{m}_1) = \sqrt{V(\hat{m}_1)} = \sqrt{V(\frac{x+y}{2})} = \sqrt{\frac{1}{4}(V[X]+V[Y])} \\
  &= \frac{\sqrt{9}}{2} = \frac{3}{2} \\
\end{align*}


\subsection{Konfidensintervall för $\mu$ från $N(\mu,\sigma^2)$ med känt $\sigma$}
\begin{align*}
  &\quad  \text{Estimatorn } \hat{\mu}=\overline{x}=\frac{1}{n}(X_1+X_2+...+X_n) \\
  &\quad  \overline{X}\sim{N(\mu,\sigma^2/n)} \\
  &\quad  \frac{\overline{X}-\mu}{\sigma/\sqrt{n}}\sim{N(0,1)} \\
  &\quad  \\
  &\quad  A=\overline{X}-\lambda_{\alpha/2}\frac{\sigma}{\sqrt{n}} \\
  &\quad  B=\overline{X}+\lambda_{\alpha/2}\frac{\sigma}{\sqrt{n}} \\
\end{align*}

\subsection{Example}
\begin{align*}
  &\text{Vid tillverkningsproncessen av axlar av rundstål} \\
  &\text{kontrollers diametern.} \\
  &\text{Följande diametrar (mm) uppmättes:} \\
  &30.02, \, 30.12, \, 30.07, \, 29.95, \, 30.05, \, 29.90, \, 30.01 \\
  &\text{Konstruera ett konfidensintervall, med} \\
  &\text{konfidensgrad $0.95$, för den förväntade} \\
  &\text{diametern.} \\
  &\\
  &n=7, \, \alpha=0.05 \\
  &\overline{X}=\frac{30.02+30.12+30.07+29.95}{n} \\
  &\cdot \frac{30.05+29.90+30.01}{n}=\frac{210.12}{7} \\
  &s=\frac{1}{n-1}\sum_{i=1}^n(x_i-\overline{x})^2 \\
  &= \frac{1}{6}((30.02-\overline{x})^2 + (30.02-\overline{x})^2) \\
\end{align*}

\subsection{Konfidensintervall för $p$ från binomialfördelad}
\begin{align*}
  &\quad  \text{Finns många alternativa metoder}  \\
  &\quad  \\
  &\quad  Bin(n,p)\sim{N(np,np(1-p))} \text{ om } np(1-p)\geq10 \\
  &\quad  \Rightarrow I_p=[\hat{p}\pm\lambda\sqrt{\hat{p}(1-\hat{p})/n}] \\
  &\quad  \text{konfidensintervall för $\theta$ (med konfidensgrad $1-\alpha$)} \\
\end{align*}

\subsection{Konfidensintervall för skillnad i väntevärde }
\begin{align*}
  &\quad  \text{Vill ofta jämföra två grupper}  \\
  &\quad  \\
  &\quad  x_1,...,x_n \text{ från } N(\mu_1,\sigma^2_1) \\
  &\quad  y_1,...,y_n \text{ från } N(\mu_2,\sigma^2_2) \\
  &\quad  \text{Söker $\mu_1-\mu_2$. Om detta intervall inhåller $0$ } \\
  &\quad  \text{då kan vi med konfidensgrad $1-\alpha$ säga att}  \\
  &\quad  \text{det är skillnad på väntevärdena}  \\
\end{align*}

\subsubsection{Okända varianser}
\begin{align*}
  &\quad  s_p^2 = \frac{(n-1)s_1^p+(m-1)s_2^2}{(n-1)+(m-1)} \\
  &\quad  \frac{\overline{X}-\overline{Y}-(\mu_1-\mu_2)}{s_p\sqrt{1/n+1/m}} \\
  &\quad  I_{\mu_1-\mu_2} = [\overline{X}-\overline{Y}\pm t_{\alpha/2}(n+m-2)s_p\sqrt{1/n+1/m}] \\
\end{align*}

\subsection{Ensidiga intervall}
\begin{align*}
  &\quad  \text{Låt $A$ och $B$ vara funktioner av }  x_1,...,x_n \\
  &\quad  \text{För ett nedåt begänsat konfidensintervall gäller} \\
  &\quad  p(\theta\geq{A})=1-\alpha \\
  &\quad  \text{För ett uppåt begrensat gäller} \\
  &\quad  p(\theta\leq{B})=1-\alpha \\
\end{align*}

\subsection{Stickprov i par}
\begin{tabular}{c|c|c}
 Fotgängare &  A & B \\
 \hline
     1      & 43  & 32 \\
     2      & 81  & 90 \\
     3      & 11  & 7 \\
     4      & 49  & 31 \\
     5      & 22  & 26 \\
     6      & 143 & 168 \\
     7      & 24  & 31 \\
     8      & 56  & 39 \\
     9      & 31  & 29 \\
    10      & 53  & 57 \\
\end{tabular}
Tiden det tar för A respektive B att upptäcka
Pforgängaren baserat står i tabellen.
Konstruera ett lämpligt konfidensintervall baserat på datan. Vilken algoritm borde andvändas.
\begin{align*}
  &\text{Vi väljet ett konfidensintervall på $95\%$, } Z=A-B \\
  &\overline{Z}=3/10=0.3, \; s^2_Z=\frac{1}{10-1}\sum_{i=1}^{10}(Z_i-\overline{Z})=13.08, \\
  &t_{0.025}(t)=2.26 \\
  &I_{\mu} = [\overline{Z}\pm t_{0.025}(t)\frac{s}{\sqrt{n}}] \\
  &        = [-9.05, 9.65]
\end{align*}
$0$ finns i intervallet, med konfidensgrad $0.95$ kan ingen
skillnad påvissas mellan algoritmerna samla in mer data,
allternativ andvänd vilken algoritm som helst.

%exemple

\section{Regrission}
\subsection{Modell}
\begin{align*}
  &\text{Givet observationsparen $x_1,...,x_n$ och $y_1,...,y_n$} \\
  &\text{ansätter man följade modell.} \\
  &Y_i = m+kx_i+\epsilon_i \text{ Där } \epsilon_i\sim{N(0,\sigma^2)} \\
\end{align*}

\subsection{Modellens giltighet}
\begin{align*}
  &\quad  \text{Konrelationskoeficent: } r=\frac{S_{xy}}{\sqrt{S_{xx}\cdot S_{yy}}} \\
\end{align*}

\subsubsection{Förklaringsgrad}
\begin{align*}
  &\quad  R^2=\frac{S²_{xy}}{\sqrt{S_{xx}\cdot S_{yy}}} \\
\end{align*}

\subsubsection{Residualer}
\begin{align*}
  &e_i=y_i-(\hat{m}+\hat{k}x_i) \\
  &\\
  &\text{Residualer bör uppfylla visa krav}\\
  &\text{(1) konstat varians, oberonde av x} \\
  &\text{(2) Residualerna bör vara oberonde av varandra} \\
  &\text{(3) Residualerna bör vara normalfördelade} \\
  &\\
  &\text{Vi bedömmer dessa visuelt} \\
  &\text{(i) Plottar residualerna i ett histogram, där vi} \\
  &\text{  kan se om det kan vara normal fördelat} \\
  &\text{(ii) Plottar residualerna i q-q plot} \\
  &\text{  På x-axeln kvatiler från en s..fördelning} \\
  &\text{  På y-axeln kvatiler från residualerna} \\
  &\text{(iii) Ritar ett spridnings diagram över x-värderna} \\
  &\text{ mot residualerna ej ett mönster $\Rightarrow$ från $X$} \\
  &\text{(iiii) Ritar ett spridnings diagram över} \\
  &\text{ residualerna mot det förutspodda y-värdet} \\
  &\text{ vill se ett jämt utpridning utan mönster} \\
\end{align*}

\subsection{Användning av modellen}
\begin{align*}
  &\text{Konfidensintervallet för parametern k} \\
  &V[\hat{m}]=\frac{\sigma^2}{n}\frac{1}{S_{xx}} \sum_{i=1}^{n}x^2_i \\
  &V[\hat{k}]=\frac{\sigma^2}{S_{xx}} \\
\end{align*}

\section{Stokastiska processer}
\subsection{Bornulli processer}
\begin{align*}
  &\text{Kommunikationskanal, överföring av slumpmäsiga} \\
  &\text{data. Tiden är uppdelad i luckor (slots)} k=1,2,3,...,n \\
  &\text{varje lucka kan hantera ett paket} \\
\end{align*}

\subsection{Poisson processer}
\textbf{Proposition:}
\begin{align*}
  &\text{För en poissonprocess $N(t), t \geq 0$ gäller att } \\
  &\text{(a) inkreten} \\
  &N(t_1),N(t_2)-N(t_1),...,N(t_k)-N(t_{k-1}) \\
  &\text{är oberonde slumpvariabel för alla} \\
  &0\leq t_1 \leq ... \leq t_k \text{ och} \\
  &\text{(b) } N(t) - N(s) \sim Po(\lambda(t-s)) \\
\end{align*}

\textbf{Ex:}
\begin{align*}
  &\text{Man att aantal fel på en kommunikationskabel.} \\
  &\text{är $1.7$. Total antal fel beskrivs av en} \\
  &\text{poisson process med parameter $\lambda=1.7$ Vad är} \\
  &\text{sannolikheten att det finns mer än två fel på} \\
  &\text{$0.5$ kilometer?} \\
  &\\
  &N(0.5)\sim Po(\lambda(0.5-0))=Po(0.85) \\
  &\Rightarrow P(N(0.5)>2) = 1-P(N(0.5)\leq2) \\
  &= 1-ppois(2, 0.85) \approx 0.0549 \\
\end{align*}

\subsubsection{Förtunning}
\begin{align*}
  &\quad  \text{Låt $N(t)$ vara en poisson process med parameter} \\
  &\quad  \text{$\lambda$, Låt ${J_n, n\in\mathbb{N}}$ vara en följ av i.i.d. $Be(p)$ } \\
  &\quad  P(J_i=1)=p, P(J_i=0)=1-p \\
  &\quad  M(t) = \sum_{k=1}^{\infty} \boldsymbol{\mathbb{1}}_{T_k\leq t}J_k \\
  &\quad  \\
  &\quad  \text{Vi kan tolka att vi skippar vissa händelser} \\
\end{align*}

\subsubsection{Superposition}
\begin{align*}
  &\text{Låt ${N(t)}$ och ${N_2(t)}$ vara en poisson process} \\
  &\text{med parameter $\lambda_1$ och $\lambda_2$} \\
  &\text{Vi vill visa att $M(t)=N_1(t)+N_2(t)$ är en} \\
  &\text{possion process med parameter $\lambda_1$ och $\lambda_2$} \\
\end{align*}

\textbf{Ex:}
\begin{align*}
  &\text{Antal inkomade samtal till en mobil kan beskrivas} \\
  &\text{som en poissonprocess med paramter $0.5$ per time} \\
  &\text{och antal sms som en poissonprocess medparamter 2} \\
  &\text{två fel på $0.5$ kilometer?} \\
  &\\
  &\text{(a) sannoliket att ingen kommunikationskabel} \\
  &\text{inkomer på en time} N_1(t) \text{ med parameter} \\
  &\lambda_1=2, \text{ -antal sms} \\
  &N_2(t) \text{ med parameter $\lambda_2=0.5$, -antal samtal} \\
  &M(t)=N_1(t)+N_2(t) \text{ med parameter $2.5$,} \\
  &\text{-antal kommunicationer} \\
  &= 1-ppois(2, 0.85) \approx 0.0549 \\
\end{align*}

\subsubsection{Spatial process}
\begin{align*}
  &\text{En samling punkter i en region $S\leq\mathbb{R}^2$} \\
  &\text{Om $N(A)$ räknar antal punkter i en mängd $A$} \\
  &\text{(där $A$ är mätbar)} \\
  &\text{då gäller att} \\
  &\text{*} N(A)\sim Po(\lambda|A|) \\
  &\text{* Om $A\cap{B}=\not{0}$ är $N(A)$ och $N(B)$ oberonde} \\
\end{align*}

\subsubsection{M/M/$\infty$-modellen}
\begin{align*}
  &\quad  N(t) \text{ -Poissonprocess, ankomster upp till tid t} \\
  &\quad  \text{ankomsterna tar tid att behandla} \\
  &\quad  \text{hur många ankomster pågår vid en viss tid?} \\
  &\quad  X_t \text{ -antal pågående ankomster vid tid t} \\
  &\quad  \text{Vi antar att varje ankomst behandlas på $exp(\lambda)/tid$} \\
\end{align*}

\section{Markovkedjor}
\begin{align*}
  &\text{En Stokastisk process ${X_n}$ i diskret tid med diskret} \\
  &\text{tillståndsrum $E$ kallas en Markovkedja om den har} \\
  &\text{Markovegenskapen} \\
  &P(X_n=x_n|X=x_0,X_1=x_1,...,X_{n-1}=x_{n-1}) \\
  &= P(X_n=x_n|X_{n-1}=x_n-1), \, \forall x_1\in{E} \land n\geq1 \\
  &\text{och övergångssanolikheten } p_{xy} \\
  &=P(X_n=y|X_{n-1}=x) \\
  &\text{ är oberonde från $n$} \\
  &\text{Vi fokuserar på } E={0,1,...,r} \text{ och } E=\mathbb{Z}_{\geq0} \\
  & \\
  &\text{Övergångsmatris:} \\
  &\left(\begin{array}{cccc}
    p_{00} & p_{01} & ... & p_{0r} \\
    p_{10} & p_{11} & ... & p_{1r} \\
    : & : & ... & : \\
    p_{r0} & p_{r1} & ... & p_{rr} \\
  \end{array}\right)
\end{align*}

\subsection{Ehrenfestmodellen}
\begin{align*}
  &\quad  \text{Oavsett startpunkt tenderar kedjan mot ett} \\
  &\quad  \text{ekvilibrium. Övergångsmatris:} \\
  &\quad  P=
  \left(\begin{array}{ccccccc}
    0 & 1 & 0 & 0 & ... & 0 & 0 \\
    1/r & 0 & 1-1/2 & 0 & ... & 0 & 0 \\
    0 & 2/r & 0 & 1-2/r & ... & 0 & 0 \\
    : &  &  &  &  & : & : \\
    0 & ... & ... & ... & ... & 1 & 0 \\
  \end{array}\right) \\
\end{align*}

\textbf{Def: stationär}
\begin{align*}
  &\text{En fördelning $\pi$ kallas stationär för en} \\
  &\text{Markovkedja med övergångsmatris $P$ om den} \\
  &\text{löser ekvationssystemt} \\
  &\pi=\pi P \\
  &\text{- $\pi$ är en egenvektor för $P$ med egenvärde $1$} \\
  &\text{- Om $\pi$ är ursprungsfördelningen } p^0=\pi \\
  &\Rightarrow p^n=\pi, \, \forall{n}\geq0 \\
\end{align*}

\textbf{Def: asymptotisk}
\begin{align*}
  &\text{En fördelning $\pi$ är en asymptotisk fördelning för} \\
  &\text{Markovkedjan ${X_n}$ om } \lim_{0\to\infty}P(X_n=k)=\pi_k, \, \\
  & \forall{k}\geq0 \text{ oberonde avursprungsfördelningen } p^0 \\
  &\\
  &\text{Asymptotiska fördelningar är alltid stationära,} 
  &\text{dock inte tvärt om} \\
\end{align*}

\textbf{Def: Irreducibel, Aperiodisk}
\begin{align*}
  &\text{En markovkedja ${X_n}$ kallas } \\
  &\text{-Irreducibel om $P(X_n=j|X_0=i)>0$ för något n och} \\
  &\text{alla $i,j\in{E}$ } \\
  &\text{-Aperiodisk om största gemensamma delaren av mängden} \\
  &{n: P(X_n=i|X_0=1)>0} \\
  &\text{är 1 för alla i } \\
  &\\
  &\text{Om en kedja är irreducibel och något $p_{ii}>0$ är kedjan} \\
  &\text{aperiodisk.} \\
\end{align*}

\textbf{Def: Tillståndsrummet}
\begin{align*}
  &\text{Låt ${X_n}$ vara aperiodisk och irreducibel} \\
  &\text{(1) Om tillsåndsrummet är ändligt finns en unik} \\
  &\text{stationär fördelning som också är asymptotisk} \\
  &\text{(2) Om tillsåndsrummet är oändligt, då om en} \\
  &\text{stationär fördelning existerar är den unik och asymptotisk} \\
\end{align*}

\textbf{Exempel: Markovkedjor}
\begin{align*}
  &P=
   \left(\begin{array}{ccc}
    3/4 & 0 & 1/4 \\
    * & 1/3 & 0 \\
    1/4 & 1/2 & ** \\
  \end{array}\right) \\
  &\text{(a) Ange $*$ och $**$} \\
  &\text{(b) Rita övergångsgrafen} \\
  &\text{(c) argumentera för att kedjan är aperiodisk och} \\
  &\text{irreducibel} \\
  &\text{(d) Bestäm den stationära fördelningen} \\
  &\\
  &\text{(a) } *=1 -(1/3+0) = 2/3, \, **= 1-(1/4+1/2)=1/4 \\
  &\text{(b) Rita övergångsgrafen} \\
  &\text{(c) Som man ser på övergångsgrafen att den man kan} \\
  &\text{ta sig till alla posistioner därmed så är den} \\
  &\text{irreducibel vilket också medföljer aperiodisk} \\
  &\text{(d) } (\pi_0 \pi_1 \pi_2) = (\pi_0 \pi_1 \pi_2)\cdot{p}
   \left(\begin{array}{ccc}
    3/4 & 0 & 1/4 \\
    2/3 & 1/3 & 0 \\
    1/4 & 1/2 & 1/4 \\
  \end{array}\right) \\
  &\left\{\begin{array}{rr}
  \pi_0 = 3/4\pi_0 + 2/3\pi_1 + 1/4\pi_2 \\
  \pi_1 = 0\pi_0 + 1/3\pi_1 + 1/2\pi_2 \\
  \pi_2 = 1/4\pi_0 + 0\pi_1 + 1/4\pi_2 \\
  \end{array}\right. \\
  &\pi_2=\pi_0/3, \, \pi_1=\pi_0/4 \\
  &\pi = (12 \; 3 \; 4) \text{ Normalisering: } \pi = (12/19 \; 3/19 \; 4/19) \\
\end{align*}

\subsection{Google-kedjan}
\begin{align*}
  &\text{Google skapar en graph av alla sidor} \\
  &\text{Tillståndet efter n steg beskrivs av en} \\
  &\text{Markovkedja med denna övergångsmatrisen} \\
  &\text{Google letar efter den asymptotiska fördelningen} \\
  &\text{på kedjan och rankar sidorna i sökresultatet} \\
  &\text{enligt sannolikheterna i den asymptotiska} \\
  &\text{fördelningen} \\
\end{align*}

\subsection{Hashfunktioner}
\begin{align*}
  &\text{En funktion $h$ som tar $n$ visare och sparar som} \\
  &\text{någon av $m$ möjliga hasvärden $(m<n)$} \\
\end{align*}

\subsection{Kollisionmodoll}
\begin{align*}
  &\quad  \text{Modeleras med Bernoulli-processen} \\
\end{align*}

\subsection{Markov Buffer/Markovkö}
\begin{align*}
  &\quad  \text{$X_n$ -anatal packet som anländer under slot $n$} \\
  &\quad  \text{$Q_n$ -anatal packet i kö slutet av slot $n$} \\
\end{align*}
\end{multicols}
\raggedcolumns
