%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% hydraulics.sty
%
% The symbols are based on ISO 1219
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%:File hydraulics.sty
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{hydraulics}[%
  2026/01/14 v0.0.1 Symbology to draw hydraulics circuits with TikZ
] 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%: Packages Loading

\RequirePackage{tikz}
	\usetikzlibrary{shapes}
	\usetikzlibrary{arrows.meta}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%: Definitions, Parameters and Commands

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%: Styles for Streams, Units and Signals
% Define a pump symbol
\tikzset{
  pump/.pic = {
    \draw[thick] (0,0) circle (0.5cm);
    \draw[thick,->] (135:0.3cm) -- ++(315:0.7cm);
    \node at (0,-0.7cm) {#1};
  }
}

% Define a valve symbol
\tikzset{
  valve/.pic = {
    \draw[thick] (0,0) -- ++(0,0.5cm) -- ++(0.5cm,0) -- ++(0,-0.5cm);
    \node at (0,-0.5cm) {#1};
  }
}


% Remember that you can not have a empty line
\tikzset{
  % Control Mechanisms 
  %% Mechanical Components
  %%% Rotating Shaft
  %%% Adjustible Stroke Limiter
  %%% Detent
  %%% Roller
  %%% Spring
  %% Fluidic
  %%% Pneumatic Pilot
  %%% Hydraulic Pilot
  %% Manual
  %%% General
  %%% Push button
  %%% Lever
  /tikz/lever/.pic={
    \draw[thick] (-1,0.4) -- (0,0.4);
    \draw[thick] (-0.8,0) -- (0,0);
    % y = -2x - 1.6
    \draw[thick] (-1.2,0.8) -- (-0.7,-0.2);
    \fill (-1.2,0.8) circle (0.6mm);
    \coordinate (-right) at (0,-0.3);
  },
  %%% Pedal
  /tikz/pedal/.pic={
    \draw[thick] (-0.8,0.4) -- (0,0.4);
    \draw[thick] (-1,0) -- (0,0);
    % y = 2x + 2
    \draw[thick] (-1.2,-0.4) -- (-0.7,0.6);
    % (-1)-(-0.7) = 0.3, 0.6 + 0.3/2 = 0.75,  deg(150) - deg(60) = deg(90)
    \draw[thick] (-0.7,0.6) -- (-1,0.75);
    \coordinate (-right) at (0,-0.3);
  },
  %% Electrical
  %%% Solenoid
  /tikz/solenoid/.pic={
    \draw[thick] (0,0.4) -- (-0.8,0.4) -- (-0.8,0) -- (0,0);
    \draw[thick] (-0.5,0) -- (-0.3,0.4);
    \coordinate (-right) at (0,-0.3);
  },
  %%% Proportional Solenoid
  %%% Proportional Solenoid With Feedback
  % Full DCV with parameterized actuator type
  /tikz/dcv/.pic={
    \tikzset{dcv/.cd, #1}
    \edef\controlmechanism{\pgfkeysvalueof{/tikz/dcv/control mechanism}}
    % Validate actuator type
    \unless\ifnum\pdfstrcmp{\controlmechanism}{lever}=0\relax
    \unless\ifnum\pdfstrcmp{\controlmechanism}{pedal}=0\relax
    \unless\ifnum\pdfstrcmp{\controlmechanism}{solenoid}=0\relax
      \PackageError{TikZ}{Invalid Control Mechanism: '\controlmechanism'. Must be 'lever', 'pedal, or 'solenoid'}{}
    \fi\fi\fi
    \pic (cm1) at (0, 0) {\controlmechanism};
    \draw[thick] (cm1-right) rectangle (1,1);
  },
  /tikz/dcv/control mechanism/.initial=lever,
}
